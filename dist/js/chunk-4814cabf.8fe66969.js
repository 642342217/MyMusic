(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4814cabf"],{"2cb6":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"song-detail"},[n("div",{staticClass:"header"},[n("div",{staticClass:"pic"},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.picUrl,expression:"picUrl"}],attrs:{alt:t.name}})]),n("div",{staticClass:"song-content"},[n("div",{staticClass:"song-name"},[t._v(t._s(t.name))]),n("div",{staticClass:"song-artist"},[t._v("歌手："),n("span",{on:{click:t.toSonger}},[t._v(t._s(t.artist))])]),n("div",{staticClass:"play",on:{click:t.playMusic}},[n("i",{staticClass:"iconfont"},[t._v("")]),n("span",[t._v("播放")])]),n("div",{class:{lyric:!0,showAll:t.showAll}},[t._v(t._s(t.lyric))]),t.showAll?n("div",{staticClass:"show",on:{click:function(e){t.showAll=!t.showAll}}},[t._v("收起")]):n("div",{staticClass:"show",on:{click:function(e){t.showAll=!t.showAll}}},[t._v("展开")])])]),n("div",{staticClass:"comment"},[n("div",{staticClass:"comment-header"},[t._v("评论")]),n("div",{staticClass:"my-comment"},[n("div",{staticClass:"txt"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],attrs:{id:"comment",placeholder:"评论"},domProps:{value:t.inputValue},on:{click:t.vetifyStatus,input:function(e){e.target.composing||(t.inputValue=e.target.value)}}})]),n("div",{staticClass:"btn",on:{click:t.sendComment}},[t._v("评论")]),n("div",{class:{txt_number:!0,warn:!(t.number>=0)}},[t._v(t._s(t.number))])]),t.hotComments.length>0?n("div",{staticClass:"hotComments"},[t._v("精彩评论")]):t._e(),t._l(t.hotComments,(function(t){return n("Comment",{key:t.commentId,attrs:{beReplied:t.beReplied,content:t.content,liked:t.liked,likedCount:t.likedCount,user:t.user,timeStr:t.timeStr,commentId:t.commentId}})})),t.latestComments.length>0?n("div",{staticClass:"latestComments"},[t._v("最新评论")]):t._e(),t._l(t.latestComments,(function(t){return n("Comment",{key:t.commentId,attrs:{beReplied:t.beReplied,content:t.content,liked:t.liked,likedCount:t.likedCount,user:t.user,timeStr:t.timeStr,commentId:t.commentId}})}))],2),n("v-alert",{attrs:{type:"success",value:t.success}},[t._v("发表评论成功！")]),n("v-alert",{attrs:{type:"info",dismissible:""},model:{value:t.info,callback:function(e){t.info=e},expression:"info"}},[n("h5",{on:{click:t.vetifyByCaptcha}},[t._v(t._s(t.helpInfo))])])],1)},a=[],i=n("1da1"),r=(n("96cf"),n("b0c0"),n("ac1f"),n("5319"),n("365c")),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment"},[n("div",{staticClass:"head"},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.user.avatarUrl,expression:"user.avatarUrl"}],attrs:{alt:"头像"}})]),n("div",{staticClass:"bdy"},[n("div",{staticClass:"content-box"},[n("span",{staticClass:"name"},[t._v(t._s(t.user.nickname))]),t._v(":"),n("span",{staticClass:"content"},[t._v(t._s(t.contents))])]),t.beReplied.length?n("div",{staticClass:"replied"},[n("span",{staticClass:"name"},[t._v(t._s(t.beReplied[0].user.nickname))]),t._v(":"),n("span",{staticClass:"content"},[t._v(t._s(t.beReplied[0].content))])]):t._e(),n("div",{staticClass:"footer"},[n("div",{staticClass:"time"},[t._v(t._s(t.timeStr))]),n("div",{staticClass:"liked-reply"},[n("i",{class:{liked:t.liked,iconfont:!0},on:{click:t.like}},[t._v("")]),t.likedCount?n("span",{staticClass:"likedCount"},[t._v("("+t._s(t.likedCount)+")")]):t._e(),n("span",[t._v(" | ")]),n("span",{staticClass:"reply-content",on:{click:t.vetifyStatus}},[t._v("回复")])])])])])},c=[],u={props:["user","content","beReplied","likedCount","timeStr","liked","commentId"],methods:{like:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].getLoginStatus();case 2:if(n=e.sent,s=n.data,null!==s.data.account){e.next=6;break}return e.abrupt("return",t.$store.commit("changeShowLoginBox",!0));case 6:if(!t.liked){e.next=12;break}return e.next=9,r["a"].likeCommentOfSong(t.$route.query.id,t.commentId,0);case 9:t.$bus.$emit("updateComments",""),e.next=15;break;case 12:return e.next=14,r["a"].likeCommentOfSong(t.$route.query.id,t.commentId,1);case 14:t.$bus.$emit("updateComments","");case 15:case"end":return e.stop()}}),e)})))()},vetifyStatus:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].getLoginStatus();case 2:n=e.sent,s=n.data,null===s.data.account&&t.$store.commit("changeShowLoginBox",!0);case 5:case"end":return e.stop()}}),e)})))()}},computed:{contents:function(){return this.content.replace("/n","")}}},l=u,m=(n("7563"),n("2877")),d=Object(m["a"])(l,o,c,!1,null,"94f7da5a",null),v=d.exports,p={data:function(){return{number:140,inputValue:"",id:"",songId:"",name:"",picUrl:"",artist:"",lyric:"",showAll:!1,songUrl:"",latestComments:[],hotComments:[],success:!1,info:!1,helpInfo:""}},methods:{getSongDetail:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].getDetailOfSong(t.$route.query.id);case 2:n=e.sent,s=n.data,t.id=s.songs[0].ar[0].id,t.songId=s.songs[0].id,t.name=s.songs[0].name,t.picUrl=s.songs[0].al.picUrl,t.artist=s.songs[0].ar[0].name;case 9:case"end":return e.stop()}}),e)})))()},getLyric:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].getLyric(t.$route.query.id);case 2:n=e.sent,s=n.data,t.lyric=s.lrc.lyric,a=/\[[0-9]*:[0-9]*\.[0-9]*\]/g,t.lyric=t.lyric.replace(a,"");case 7:case"end":return e.stop()}}),e)})))()},toSonger:function(){this.$router.push({path:"artist",query:{id:this.id}})},playMusic:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].getSongUrl(t.songId);case 2:n=e.sent,s=n.data,t.songUrl=s.data[0].url,t.$store.commit("playSong",t.songUrl);case 6:case"end":return e.stop()}}),e)})))()},sendComment:function(){var t=this,e=r["a"].sendCommentOfSong(this.songId,this.inputValue);e.then((function(e){200===e.data.code?(t.inputValue="",t.success=!0,setTimeout((function(){t.success=!1}),1e3)):(t.helpInfo=e.data.data.dialog.subtitle,t.info=!0)}),(function(t){console.error(t)}))},getComments:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].getCommentOfSong(t.$route.query.id);case 2:n=e.sent,s=n.data,t.latestComments=s.comments,t.hotComments=s.hotComments;case 6:case"end":return e.stop()}}),e)})))()},vetifyByCaptcha:function(){this.$bus.$emit("vetifyByCaptcha",""),this.info=!1},vetifyStatus:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["a"].getLoginStatus();case 2:n=e.sent,s=n.data,null===s.data.account&&t.$store.commit("changeShowLoginBox",!0);case 5:case"end":return e.stop()}}),e)})))()}},watch:{inputValue:function(t){this.number=140-t.length}},created:function(){this.getSongDetail(),this.getLyric(),this.getComments()},mounted:function(){var t=this;this.$bus.$on("updateComments",(function(){t.getComments()}))},beforeDestroy:function(){this.$bus.$off("updateComments")},components:{Comment:v}},f=p,h=(n("b933"),n("6544")),g=n.n(h),C=n("0798"),k=Object(m["a"])(f,s,a,!1,null,"b9222d34",null);e["default"]=k.exports;g()(k,{VAlert:C["a"]})},"2e77":function(t,e,n){},5781:function(t,e,n){},7563:function(t,e,n){"use strict";n("5781")},b933:function(t,e,n){"use strict";n("2e77")}}]);
//# sourceMappingURL=chunk-4814cabf.8fe66969.js.map